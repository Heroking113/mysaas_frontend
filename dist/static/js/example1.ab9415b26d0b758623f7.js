(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[2],{305:function(t,e,a){"use strict";a.r(e);var i=a(321);var s=a(309);for(var n in s)if(n!=="default")(function(t){a.d(e,t,function(){return s[t]})})(n);var r=a(318);var l=a(12);var o=Object(l["a"])(s["default"],i["a"],i["b"],false,null,"1c744da0",null);e["default"]=o.exports},309:function(t,e,a){"use strict";a.r(e);var i=a(310);var s=a.n(i);for(var n in i)if(n!=="default")(function(t){a.d(e,t,function(){return i[t]})})(n);e["default"]=s.a},310:function(t,e,a){"use strict";var i=a(2);Object.defineProperty(e,"__esModule",{value:true});e.default=void 0;var s=i(a(98));var n=i(a(99));var r={components:{},data:function t(){return{tableData:[],baseBusinessData:[],bk_biz_id:"",baseScriptData:[],content:"",selected_bk_biz_id:"",hostIps:new Array}},created:function t(){var e=this;this.$http.get("/query_all_info/").then(function(t){if(t.status===200){var a=JSON.parse(JSON.stringify(t.data));e.tableData=a.host_data;e.baseBusinessData=a.business_data;e.baseScriptData=a.script_data}else{e.$message.error("获取信息失败！")}})},mounted:function t(){(0,s.default)("#execute").click(function(){(0,s.default)("#execute").css("background","#008272")})},methods:{onSubmit:function t(){var e=this;var a={};if(this.selected_bk_biz_id!==""){a["bk_biz_id"]=this.selected_bk_biz_id}else{this.$message.warning("请选择业务");return}var i=(0,s.default)("#cur_script").val();if(i!==""){a["script"]=i}else{this.$message.warning("请选择脚本");return}if(this.hostIps.length>0){var r=[];this.hostIps.forEach(function(t){r.push(t)});a["host_ips"]=r.join(",")}else{this.$message.warning("请至少选择一台主机");return}this.$http.post("/execute_script/",n.default.stringify(a)).then(function(t){if(t.data.condition){e.$message.success("执行成功!")}else{e.$message.error("执行失败!")}})},goRecord:function t(){this.$router.push({path:window.PROJECT_CONFIG.SITE_URL+"task-record"})},get_select_business_label:function t(e){var a=this;this.selected_bk_biz_id=e;var i=new FormData;i.append("bk_biz_id",this.selected_bk_biz_id);var s="/query_host_info/?bk_biz_id="+this.selected_bk_biz_id;this.$http.get(s).then(function(t){if(t.status===200){var e=JSON.parse(JSON.stringify(t.data.host_data.data.info));a.tableData=[];e.forEach(function(t){a.tableData.push(t["host"])})}else{a.$message.error("获取当前业务下的主机信息失败！")}})},handleSelectionChange:function t(e){this.hostIps.splice(0,this.hostIps.length);for(var a in e){this.hostIps.push(e[a]["bk_host_innerip"])}}}};e.default=r},311:function(t,e,a){},318:function(t,e,a){"use strict";var i=a(311);var s=a.n(i);var n=s.a},321:function(t,e,a){"use strict";var i=function(){var t=this;var e=t.$createElement;var a=t._self._c||e;return a("div",[a("el-container",[a("el-header",{staticClass:"head-left-content"},[a("el-button",{staticClass:"navibar-button-style",staticStyle:{"background-color":"#0a6659"},attrs:{id:"execute",type:"primary"}},[t._v("执行任务")]),t._v(" "),a("el-button",{staticClass:"navibar-button-style",attrs:{type:"primary"},on:{click:t.goRecord}},[t._v("任务记录")])],1)],1),t._v(" "),a("div",{staticClass:"table-style"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:true}},[a("el-form-item",{attrs:{label:"选择业务"}},[a("el-select",{ref:"select_business",staticStyle:{width:"160px"},attrs:{id:"cur_business",placeholder:"请选择"},on:{change:t.get_select_business_label},model:{value:t.bk_biz_id,callback:function(e){t.bk_biz_id=e},expression:"bk_biz_id"}},t._l(t.baseBusinessData,function(t){return a("el-option",{key:t.bk_biz_id,attrs:{label:t.bk_biz_name,value:t.bk_biz_id}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"选择脚本"}},[a("el-select",{ref:"select_script",staticStyle:{width:"280px"},attrs:{id:"cur_script",placeholder:"请选择"},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}},t._l(t.baseScriptData,function(t){return a("el-option",{key:t.content,attrs:{label:t.name,value:t.content}})}),1)],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("执行")])],1)],1),t._v(" "),a("hr",{staticStyle:{FILTER:"alpha(opacity=100,finishopacity=0,style=3)"},attrs:{width:"100%",color:"gray",size:"1"}}),t._v(" "),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.tableData,"tooltip-effect":"dark"},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),a("el-table-column",{attrs:{prop:"bk_host_innerip",label:"IP",width:"250"}}),t._v(" "),a("el-table-column",{attrs:{prop:"bk_os_name",label:"操作系统",width:"250"}}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){a.preventDefault();t.deleteRow(e.$index,t.tableData)}}},[t._v("待定")])]}}])})],1)],1)],1)};var s=[];a.d(e,"a",function(){return i});a.d(e,"b",function(){return s})}}]);